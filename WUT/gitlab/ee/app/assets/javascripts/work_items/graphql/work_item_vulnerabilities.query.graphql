#import "~/graphql_shared/fragments/page_info.fragment.graphql"

query workItemVulnerabilities(
  $fullPath: ID!
  $iid: String!
  $first: Int = 25
  $after: String = ""
) {
  workspace: namespace(fullPath: $fullPath) {
    id
    workItem(iid: $iid) {
      id
      iid
      namespace {
        id
      }
      widgets {
        ... on WorkItemWidgetVulnerabilities {
          type
          relatedVulnerabilities(first: $first, after: $after) {
            nodes {
              id
              state
              severity
              name
              webUrl
            }
            pageInfo {
              ...PageInfo
            }
            count
          }
        }
      }
    }
  }
}
