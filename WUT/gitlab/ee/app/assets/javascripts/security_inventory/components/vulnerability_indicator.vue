<script>
import { formatNumber } from '~/locale';
import { SEVERITY_SEGMENTS, SEVERITY_BACKGROUND_COLORS } from '../constants';
import { getVulnerabilityTotal } from '../utils';
import SegmentedBar from './segmented_bar.vue';

export default {
  components: {
    SegmentedBar,
  },
  props: {
    counts: {
      type: Object,
      required: false,
      default: () => ({}),
    },
  },
  computed: {
    totalCount() {
      return formatNumber(getVulnerabilityTotal(this.counts));
    },
    severitySegments() {
      return SEVERITY_SEGMENTS.map((severity) => ({
        class: SEVERITY_BACKGROUND_COLORS[severity],
        count: this.counts?.[severity] || 0,
      }));
    },
  },
};
</script>
<template>
  <div>
    <segmented-bar :segments="severitySegments" />
    <span class="gl-text-sm gl-text-status-neutral">
      {{ totalCount }}
    </span>
  </div>
</template>
