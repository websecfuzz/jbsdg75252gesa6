# frozen_string_literal: true

module Llm
  class ResolveVulnerabilityService < BaseService
    def valid?
      super && Ability.allowed?(user, :resolve_vulnerability_with_ai, resource)
    end

    private

    def ai_action
      :resolve_vulnerability
    end

    def perform
      schedule_completion_worker
    end
  end
end
