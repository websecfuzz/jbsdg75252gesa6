<% if llm_patch.present? %>
<% if description_options&.dig(:vulnerable_mr) %>
<% mr_url = description_options.dig(:vulnerable_mr).then { |mr| Gitlab::Routing.url_helpers.project_merge_request_url(mr.target_project, mr) } %>
Vulnerability finding detected in merge request: <%= "#{mr_url}+s" %>
<% else %>
MR created from vulnerability: [<%= vulnerability.title %>](<%= vulnerability_url(vulnerability) %>)
<% end %>

## AI GENERATED FIX
The suggested code changes were generated by GitLab Duo Vulnerability Resolution, an AI feature. **Use this feature with caution.** Before you run a pipeline or apply the code changes, carefully review and test them, to ensure that they solve the vulnerability.

The large language model that generated the suggested code changes was provided with the entire file that contains the vulnerable lines of code. It is not aware of any functionality outside of this context.

Please see [our documentation](https://docs.gitlab.com/ee/user/application_security/vulnerabilities/#vulnerability-resolution) for more information about this feature.

<% end %>
### Description:

<%= finding.description || finding.name %>

<% if vulnerability.severity.present? %>
* Severity: <%= vulnerability.severity %>
<% end %>
<% if defined?(vulnerability.file) && vulnerability.file.present? %>
* Location: [<%= finding.location_text %>](<%= finding.location_link %>)
<% end %>

<% if description_options && description_options[:analysis_data].present? %>
### Analysis:
<%= description_options[:analysis_data].html_safe %>
<% end %>
<% if description_options && description_options[:summary_data].present? %>
### Summary:
<%= description_options[:summary_data].html_safe %>
<% end %>
<% if vulnerability.solution.present? %>
### Solution:

<%= vulnerability.solution %>
<% end %>

<% if vulnerability.identifiers.present? %>
### Identifiers:

<% vulnerability.identifiers.each do |identifier| %>
<% if identifier[:url].present? %>
* [<%= identifier[:name] %>](<%= identifier[:url] %>)
<% else %>
* <%= identifier[:name] %>
<% end %>
<% end %>
<% end %>

<% if vulnerability.links.present? %>
### Links:

<% vulnerability.links.each do |link| %>
<% if link['name'].present? %>
* [<%= link['name'] %>](<%= link['url'] %>)
<% else %>
* <%= link['url'] %>
<% end %>
<% end %>
<% end %>
