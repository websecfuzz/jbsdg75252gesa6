# frozen_string_literal: true

module Types
  module Security
    module VulnerabilityStatisticInterface
      include Types::BaseInterface

      field :updated_at, Types::TimeType,
        null: true,
        description: 'Date that data was last updated.'

      field :total,
        type: GraphQL::Types::Int,
        null: false,
        description: 'Total of all vulnerabilities.'

      ::Enums::Vulnerability.severity_levels.each_key do |severity|
        field severity,
          GraphQL::Types::Int,
          null: false,
          description: "Number of vulnerabilities of #{severity.upcase} severity."
      end
    end
  end
end
