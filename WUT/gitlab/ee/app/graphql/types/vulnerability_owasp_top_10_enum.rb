# frozen_string_literal: true

module Types
  class VulnerabilityOwaspTop10Enum < BaseEnum
    graphql_name 'VulnerabilityOwaspTop10'
    description 'OwaspTop10 category of the vulnerability'

    # GraphQL names can only contain _, letter, numbers.
    # See: https://spec.graphql.org/draft/#sec-Names
    # So working around by having only label and year with an underscore.
    # Example: { "A1:2017-Injection" => "A1_2017" }
    NAME_MAP = ::Enums::Vulnerability::OWASP_TOP_10_BY_YEAR['2017'].each_with_object({}) do |(key, _), result|
      identifier = key.split('-').first.tr(':', '_')
      result[key] = identifier
    end

    NAME_MAP.each do |owasp_key, owasp_value|
      value owasp_value.upcase, value: owasp_key,
        description: "#{owasp_key}, OWASP top 10 2017 category."
    end

    value 'NONE',
      value: ::Security::VulnerabilityReadsFinder::FILTER_NONE,
      description: 'No OWASP top 10 2017 category.'
  end
end
