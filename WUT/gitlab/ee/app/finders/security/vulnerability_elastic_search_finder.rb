# frozen_string_literal: true

# Security::VulnerabilityElasticSearchFinder
#
# Used to filter Vulnerability records for Vulnerabilities API from vulnerabilities elasticsearch index
#
# Arguments:
#   see in ee/app/finders/security/vulnerability_elastic_base_finder.rb

module Security
  class VulnerabilityElasticSearchFinder < VulnerabilityElasticBaseFinder # rubocop:disable Search/NamespacedClass -- Keeping this in the Security namespace as it is used specifically by security classes
    def execute
      query = ::Search::Elastic::VulnerabilityQueryBuilder.build(query: nil, options: search_params)

      options = es_search_options.merge({
        primary_key: Vulnerabilities::Read.primary_key.to_sym
      })

      Search::Elastic::Relation.new(Vulnerability, query, options)
    end
  end
end
