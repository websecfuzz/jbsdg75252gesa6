# frozen_string_literal: true

RSpec.shared_examples 'nullifies dismissal fields from associated vulnerability read' do
  before do
    vulnerability.vulnerability_read.update!(dismissal_reason: :false_positive)
  end

  it 'nullifies the dismissal fields on the associated vulnerability_read' do
    subject

    expect(vulnerability.reload.vulnerability_read).to have_attributes(dismissal_reason: nil)
  end
end
