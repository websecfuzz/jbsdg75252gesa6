# frozen_string_literal: true

RSpec.shared_examples 'a vulnerability elastic finder' do
  describe 'calls execute_search' do
    it 'with index and routing params for elasticsearch' do
      expect(::Gitlab::Search::Client).to receive(:execute_search).with(
        query: anything,
        options: hash_including(:index_name, :root_ancestor_ids)
      ).and_call_original

      is_expected
    end
  end
end
