# frozen_string_literal: true

module Search
  module Elastic
    module RecordProxy
      # Vulnerability-specific record proxy that provides optimized access
      # to elasticsearch indexing data including EPSS scores, CVE values,
      # and reachability information.
      class Vulnerability < Base
        # Creates a vulnerability proxy with all optimizations applied
        def self.create_with_enhancements(record, enhancements)
          proxy = new(record)

          proxy.enhance_with_data({
            reachability: enhancements[:reachability]
          })

          proxy
        end
      end
    end
  end
end
