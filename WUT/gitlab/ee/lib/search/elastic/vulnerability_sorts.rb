# frozen_string_literal: true

module Search
  module Elastic
    module VulnerabilitySorts
      class << self
        def sort_by(query_hash:, options:)
          sort_hash = build_sort(options[:sort])
          query_hash.merge(sort: sort_hash)
        end

        private

        def build_sort(sort)
          case sort
          when :severity_asc
            { severity: { order: 'asc' }, vulnerability_id: { order: 'desc' } }
          when :severity_desc
            { severity: { order: 'desc' }, vulnerability_id: { order: 'desc' } }
          when :detected_asc
            { vulnerability_id: { order: 'asc' } }
          when :detected_desc
            { vulnerability_id: { order: 'desc' } }
          else
            {}
          end
        end
      end
    end
  end
end
